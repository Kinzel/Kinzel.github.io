---
title: "Listar FIIs como um supermercado"
author: "Guilherme Kinzel"
date: 2021-03-27T21:13:14-05:00
categories: ["R"]
tags: ["FII", "R", "Web scrapping"]
---



<p><em>J√° se imaginou dentro de um supermercado de FIIs?</em></p>
<center>
<img src="/images/supermarket.jpg" width="250" />
</center>
<p>Passeando pelos corredores do setor de Log√≠stica, h√° nas prataleiras:</p>
<ul>
<li><strong>FII A</strong> com 5,0% <em>Dividend Yield</em> e 20% do caixa dispon√≠vel e;</li>
<li><strong>FII B</strong> com 6,0% <em>Dividend Yield</em> e 1% do caixa dispon√≠vel.</li>
</ul>
<p>Perceba que ao analisar a embalagem voc√™ facilmente pode mudar de opini√£o de qual produto levar para casa.</p>
<p>Aqui neste post do blog <em>I‚Äôm GK!</em> eu ajudarei voc√™ a fazer uma lista completa de todos os FIIs negoci√°veis na Bovespa, e quem escolhe as informa√ß√µes da embalagem √© voc√™!</p>
<p><em>Este √© o primeiro post da s√©rie aposentadoria personalizada.</em></p>
<div id="introdu√ß√£o" class="section level2">
<h2>Introdu√ß√£o</h2>
<p>Nesse post eu mostrarei e ensinarei fazer uma tabela de FIIs para voc√™ tomar as melhores decis√µes de investimento para forma√ß√£o de renda futura. Abaixo uma imagem exemplo de como ficar√° a nossa tabela com os indicadores escolhidos!</p>
<center>
<p><img src="/images/tabelafiiex.png" width="400" /></p>
<font size = "1">Aperte na imagem para aproximar</font>
</center>
<p>Voc√™ pode visualizar a tabela completa <a href="http://">aqui</a>.</p>
<p>No final, utilizaremos o maquin√°rio do R para estudarmos os setores e tra√ßaremos gr√°ficos para melhor apoiarmos nossas decis√µes.</p>
<p>Caso voc√™ n√£o saiba o que seja um FII ‚ö†Ô∏è (fundo de investimento imobili√°rio) talvez esse n√£o seja um conte√∫do para voc√™ - ainda! Recomendo que estude um pouco mais sobre o assunto, pois n√£o abordaremos t√≥picos que outros j√° entraram em profundidade, por exemplo: como compr√°-los na corretora, o que s√£o rendimentos e etc.</p>
</div>
<div id="indicadores" class="section level2">
<h2>Indicadores</h2>
<p>No nosso supermercado de FIIs somos n√≥s que escolhemos as embalagens! Escolheremos os indicadores que mais nos expressar√£o em poucas palavras - ou n√∫meros.</p>
<p><font size = "2"></p>
<ol style="list-style-type: decimal">
<li>Ticker</li>
<li>Nome</li>
<li>Setor</li>
<li>Gestor</li>
<li>Cota√ß√£o</li>
<li>Volume m√©dio di√°rio</li>
<li>P/VP</li>
<li>MM200</li>
<li>√öltimo <em>Yield</em></li>
<li><em>Dividend Yield</em></li>
<li>Mediana <em>Yields (1M)</em> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
<li>Valor em caixa</li>
</ol>
<p></font></p>
<p>Queremos ter uma boa id√©ia na hora de analisarmos as prateleiras: qual setor pertence? Quanto √© o seu P/VP? Vislumbrando de um todo, eventualmente poderemos prospectar mais afundo o FII para levarmos para adquirirmos e levar para casa.</p>
<div id="por-que-destes-indicadores" class="section level4">
<h4>Por que destes indicadores?</h4>
<p><em>(cont√©m opini√µes pessoais)</em></p>
<p><strong>Setor:</strong> n√£o invista em FIIs que perten√ßam a setores com futuro nebuloso ou em que o inquilino tenha muito poder de negocia√ß√£o no contrato. Setores que na minha avalia√ß√£o s√£o de boa seguran√ßa para longo prazo, exemplos: residenciais, shoppings, papel (que seja bem diversificado), log√≠stica. Exemplos de n√£o seguros ou poder de negocia√ß√£o excessivo: ag√™ncias banc√°rias, hospitais. N√£o leve as minhas conclus√µes como suas tamb√©m, fa√ßa a sua pr√≥pria an√°lise!</p>
<p><strong>Gestor:</strong> √© o DNA do FII. Assunto pouco abordado, pois quando √© comentado sobre diversifica√ß√£o √© mais discorrido sobre diversifica√ß√£o setorial. N√£o menospreze a informa√ß√£o de gestor ou de administrador, porque uma grande parcela dos FIIs entrega resultado aos diretamente envolvidos e n√£o aos cotistas. Fuja de FIIs que possuam DNA que n√£o seja voltado para voc√™ - o cotista.</p>
<p><strong>Volume m√©dio di√°rio:</strong> voc√™ pode correr o risco de n√£o conseguir vender ou rotacionar os ativos em caso de oportunidades aparecerem. Sempre d√™ prefer√™ncia a FIIs de volume m√©dio di√°rio razo√°veis.</p>
<p><strong>P/VP:</strong><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> m√©trica muito utilizada no mercado, entretanto, na minha avalia√ß√£o pessoal, este indicador √© <em>overrated</em> <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>: simplifica excessivamente a avalia√ß√£o. Use-o com cautela, deixar de comprar FIIs que possuam P/VP &gt; 1 pode levar voc√™ a perder √≥timas oportunidades.</p>
<p><strong>MM200:</strong> a diferen√ßa entre o pre√ßo da cota e a m√©dia m√≥vel de 200 per√≠odos. Indicador excelente para saber quando a cota est√° ‚Äúespichada‚Äù para cima, ou para baixo. Ser√° essencial para an√°lises em sintonia do <em>JdK RS-Momentum</em> do <a href="https://www.relativerotationgraphs.com/">RRG charts</a>, ou <em>relative rotational graphs</em>.</p>
<p><strong>Yields:</strong> nosso foco ser√° montar uma carteira de renda para longo prazo e aqui est√° o que n√£o pode faltar na nossa embalagem. N√£o queremos saber se somente ele ir√° nos pagar bem, mas tamb√©m a sua regularidade. Usamos mediana ao inv√©s de m√©dia porque a primeira √© muito mais resistente a <em>outliers</em>, um FII pode dar um rendimento extremamente at√≠pico, e a avalia√ß√£o da m√©dia ficar√° descaracterizada por causa da amostra abrupta, j√° a mediana n√£o ser√° t√£o afetada - prefira mediana √† m√©dia nestas ocasi√µes. Perceba a diferen√ßa que a escolha dum <em>yield</em> adequado no exemplo abaixo:</p>
<p>Dois investidores come√ßam a montar sua aposentadoria personalizada, ambos com inicialmente <span class="math inline">\(R\$ \text{ 5000}\)</span> e depositam mensalmente <span class="math inline">\(R\$ \text{ 500}\)</span>, reinvestem todo o valor com a mesma taxa de juros. Desconsidere o risco de reivestimento (n√£o conseguir investir a mesma taxa de juros).
<font size = "2"></p>
<ul>
<li>Investidor A preferiu pelo investimento com <em>Dividend Yield</em> de 5,0%.</li>
<li>Investidor B preferiu pelo investimento com <em>Dividend Yield</em> de 6,0%.
</font></li>
</ul>
<p><img src="/post/2021-03-27-listar-fiis_files/figure-html/unnamed-chunk-1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>A diferen√ßa percentual entre as aposentadorias √© aproximadamente de <span class="math inline">\(\frac{721}{578} = 1,24 \to 24\%\)</span>. Perceba que a curva do investidor B se descola do investidor A, e tamb√©m estamos falando de 143 mil reais de diferen√ßa!</p>
<p>A boa not√≠cia √© que na tabela que iremos gerar voc√™ ir√° descobrir que h√° FIIs que pagam bem mais do que os <em>Dividend Yield</em> apresentados! Removendo aqueles que n√£o est√£o pagando <em>Dividend Yield</em> por algum motivo em especial, enquanto escrevo esse post, a mediana de <em>Dividend Yield</em> dos FIIs restantes (220 FIIs) √© de 6,12%. üöÄ</p>
<p><strong>Valor em caixa:</strong> nosso √∫ltimo par√¢metro √© para avaliar o espa√ßo de manobra do FII. Perceba que o FII que h√° recurso financeiro de sobra por muito tempo √© sin√¥nimo de inefici√™ncia do gestor, alguns FIIs at√© consideram n√£o cobrar taxa de performance quando o cen√°rio ocorre.</p>
<p>Valores que n√£o foram encontrados no site s√£o denotados como <code>NA</code> na tabela.</p>
</div>
</div>
<div id="kair√≥s" class="section level2">
<h2>Kair√≥s</h2>
<p><em>Kair√≥s foi na mitologia grega o deus do tempo oportuno, hoje tamb√©m referido como ‚Äúmedida certa‚Äù.</em></p>
<p>Se voc√™ n√£o √© usu√°rio da linguagem R e somente quer usar o conte√∫do explicado para gerar suas tabelas periodicamente, veja abaixo:</p>
<ul>
<li>Como instalar o R + RStudio + MT5 + mt5R.</li>
<li>Como rodar o c√≥digo para listar todos os FIIs.</li>
</ul>
<p>Pronto! Espero que eu tenha ajudado as suas decis√µes de investimento! ‚ù§Ô∏è</p>
<p>Mas se voc√™ quer programar as suas pr√≥prias <em>embalagens</em>, continue lendo! Vaamos! ‚õè</p>
</div>
<div id="as-ferramentas" class="section level2">
<h2>As ferramentas</h2>
<ul>
<li>R + RStudio</li>
<li>MT5</li>
<li>mt5R</li>
</ul>
<p>Faremos uso de t√©cnicas de <a href="https://en.wikipedia.org/wiki/Web_scraping">web scrapping</a> nos seguintes sites:</p>
<ul>
<li><a href="https://www.statusinvest.com.br/" class="uri">https://www.statusinvest.com.br/</a></li>
<li><a href="https://www.fundamentus.com.br/" class="uri">https://www.fundamentus.com.br/</a></li>
</ul>
<p>Dois excelentes sites que eu recomendo muito!</p>
<p>Voc√™ pode acessar o c√≥digo R completo que ser√° usado <a href="http://">aqui</a>.</p>
</div>
<div id="o-come√ßo" class="section level2">
<h2>O come√ßo</h2>
<pre class="r"><code>library(mt5R)
library(stringr) ## Pacote muito bom para processar strings

## Pegaremos o Ticker de todos os ativos negociaveis na B3
sTodosTickers = MT5.AllSymbols() 

## Queremos somente aqueles que possuam &#39;11&#39; no nome 
sTodosTickers = sTodosTickers[str_detect(sTodosTickers, &quot;11&quot;)] 

## Podem vir op√ß√µes junto, tiramos pelo tamanho do nome
sTodosTickers = sTodosTickers[str_length(sTodosTickers) &gt;= 5 &amp; str_length(sTodosTickers) &lt;= 6] </code></pre>
<p>Vamos dar uma espiada nos tickers candidatos, que provavelmente s√£o FIIs.</p>
<pre class="r"><code>head(sTodosTickers)
## [1] &quot;ABCP11&quot; &quot;ALUP11&quot; &quot;BBAS11&quot; &quot;BBPO11&quot; &quot;BBRC11&quot; &quot;BDRX11&quot;

length(sTodosTickers)
## [1] 361</code></pre>
<p>Percebam que h√° outros ativos que n√£o FIIs que tamb√©m foram contemplados, percebam no <strong>BBAS11</strong> acima. Em seguida temos a quantidade dos nossos candidatos usando <code>length(sTodosTickers)</code>.</p>
<p>Iremos de <em>ticker</em> em <em>ticker</em> com ajuda da p√°gina <a href="https://www.statusinvest.com.br/">statusinvest</a> para saber se o mesmo √© um FII. Caso a p√°gina retorne que o <em>ticker</em> informado n√£o foi encontrado o retiraremos da lista.</p>
<p>Veja <a href="https://statusinvest.com.br/fundos-imobiliarios/paginanaoencontrou">aqui</a> a p√°gina do <a href="https://www.statusinvest.com.br/">statusinvest</a> quando o FII n√£o √© encontrado.</p>
<pre class="r"><code>## Criaremos um vetor para armazenar se √© realmente FII
bQuaisSaoFII = rep(TRUE, length.out = length(sTodosTickers))

for(i in 1:length(sTodosTickers))
{
  ## Iremos de nome em nome
  sAtivo = sTodosTickers[i]
  
  ## Colocaremos tudo em min√∫scula para inserir na url
  sAtivo = str_to_lower(sAtivo)
  
  scrape_url &lt;- paste0(&quot;https://statusinvest.com.br/fundos-imobiliarios/&quot;, sAtivo)
  flat_html &lt;- base::readLines(con = scrape_url, encoding=&quot;UTF-8&quot;)
  
  ## Verificar se realmente √© FII
  if(any(str_detect(flat_html, &quot;o encontramos o que vo&quot;) == T))
  {
    ## Se o statusinvest.com.br informar que n√£o encontrou o ticker
    bQuaisSaoFII[i] = FALSE
  }else
  {
    ## Caso contr√°rio, √© FII!
    bQuaisSaoFII[i] = TRUE
  }
}</code></pre>
<p>Vamos dar uma espiada nos <em>tickers</em> que sobraram.</p>
<pre class="r"><code>## Filtrar aqueles que verdadeiramente s√£o FIIs
sTodosOsFIIs = sTodosTickers[bQuaisSaoFII]

head(sTodosOsFIIs)
## [1] &quot;ABCP11&quot; &quot;BBPO11&quot; &quot;BBRC11&quot; &quot;BMII11&quot; &quot;BNFS11&quot; &quot;BPFF11&quot;

length(sTodosOsFIIs)
## [1] 261</code></pre>
<p>A primeira parte foi realizada com sucesso! Temos agora o <em>ticker</em> de todos os FIIs dispon√≠veis!</p>
<p>Qual</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><em>Dividend Yield</em> em sua defini√ß√£o √© sempre em janela anual (12M), <em>Dividend Yield (1M)</em> √© cria√ß√£o do autor.<a href="#fnref1" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p><span class="math inline">\(\text{P/VP} = \frac{\text{Valor da cota}}{\text{Valor patrimonial}}\)</span><a href="#fnref2" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>Sobrestimado. N√£o possui tanto valor como √© normalmente divulgado.<a href="#fnref3" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
